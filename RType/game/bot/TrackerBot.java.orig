package bot;

import engine.brain.Bot;
import engine.brain.Brain;
import engine.brain.Category;
import engine.brain.Direction;
import engine.model.Entity;
import engine.model.PNJ;

public class TrackerBot extends Bot {
	private static final int FULL = 0;
	private static final int LOW = 1;

	private int duration;
	private int state;

	public TrackerBot(Brain b, Entity e) {
		super(b, e);
		c = Category.Adversary;
		duration = delay;
		pointsValue += 100; // valeur d'un bot de base par exemple
		state = FULL;
		HP = 2;
	}

	@Override
	public void think() {
		switch (state) {
		case FULL:
			FULL();
			break;
		case LOW:
			LOW();
			break;
		}
	}

	private void FULL() {
		if (collision(e)) {
			PNJCollision((PNJ) e, entityCollisionWith);
<<<<<<< HEAD
			HP--;
			state = LOW;
		}

		Entity entity = closest(Category.Adversary);
		if (entity == null) {
			return;
		}
		Direction d = dirOf(entity).cardinalOf();

		if (isFree(d)) {
			moveWithRotation(d);
		} else {
			tryAlternativeDirections();
		}

		delay = duration;
	}

	private void LOW() {
		if (collision(e)) {
			PNJCollision((PNJ) e, entityCollisionWith);
			HP--;
=======
>>>>>>> bots
			e.die();
		}

		Entity entity = closest(Category.Adversary);
		if (entity == null) {
			return;
		}
		Direction d = dirOf(entity).cardinalOf();

		if (isFree(d)) {
			moveWithRotation(d);
		} else {
			tryAlternativeDirections();
		}

		delay = duration;
	}

	@Override
	protected boolean isFree(Direction d) {
		Entity entity = cell(d);
		return entity == null || entity == b.getModel().player();
	}
}
